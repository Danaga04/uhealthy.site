"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[989],{30989:function(e,t,s){s.d(t,{u:function(){return I}});var r=s(94604),a=s(63465),n=s(73172),c=s(57166),i=s(25425),o=s(39838),l=s(67549),d=s(28511),u=s(8788),m=s(58994),x=s(96032),p=s(28491),h=s(23193),g=s(83579),f=s(61190),y=s(87911),j=s(73087),v=s(4705),b=s(43059),w=s(31998),N=s(4940),k=s(92182),C=s(57437),S=s(2265),Z=s(13537),P=s(7345),E=s(56935);let B=(e,t)=>{let s={brl:"pt-BR",usd:"en-US",eur:"de-DE"}[t.toLowerCase()]||"en-US";return new Intl.NumberFormat(s,{style:"currency",currency:t.toUpperCase()}).format(e/100)},L=e=>{let{settings:t,preview:s=!1,handleNextStep:r}=e,a=(0,P.useStripe)(),n=(0,P.useElements)(),[c,i]=(0,S.useState)(null),[o,l]=(0,S.useState)(!1),d=t.security||"Pagamento seguro via Stripe",u=t.ctaPay||"Pagar por",m=t.ctaSub||"Assinar por",x=t.priceButton||!0,p=async e=>{if(e.preventDefault(),!s){if(!a||!n){i("Erro ao carregar o processador de pagamento");return}l(!0),i(null);try{if("subscription"===t.mode){let{error:e}=await a.confirmSetup({elements:n,confirmParams:{return_url:t.successUrl||window.location.origin+"/payment/success"}});if(e)throw e;t.successUrl?window.location.href=t.successUrl:r()}else{let{error:e}=await a.confirmPayment({elements:n,redirect:"if_required",confirmParams:{return_url:t.successUrl||window.location.origin+"/payment/success"}});if(e)throw e;t.successUrl?window.location.href=t.successUrl:r()}}catch(e){console.error("Payment error:",e),i(e.message||"Ocorreu um erro ao processar o pagamento"),l(!1)}}};if(s)return(0,C.jsx)("div",{className:"max-w-md mx-auto p-4 border rounded-lg",children:(0,C.jsxs)("div",{className:"bg-gray-100 p-4 rounded-lg",children:[(0,C.jsx)("div",{className:"h-10 bg-gray-200 rounded mb-4"}),(0,C.jsx)("div",{className:"h-8 bg-gray-200 rounded w-3/4"})]})});let h="subscription"===t.mode?"".concat(m).concat(x?" ".concat(B(t.amount,t.currency),"/").concat("year"===t.interval?"ano":"m\xeas"):""):"".concat(u).concat(x?" ".concat(B(t.amount,t.currency)):"");return(0,C.jsxs)("form",{onSubmit:p,className:"max-w-md mx-auto p-4",children:[(0,C.jsx)("div",{className:"",children:(0,C.jsx)(P.PaymentElement,{options:{layout:"accordion"}})}),c&&(0,C.jsxs)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center space-x-2",children:[(0,C.jsx)("svg",{className:"h-5 w-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,C.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,C.jsx)("p",{className:"text-sm text-red-600",children:c})]}),(0,C.jsx)("button",{type:"submit",disabled:!a||o,className:"mt-6 w-full flex items-center justify-center py-3.5 px-4 border border-transparent rounded-lg font-medium shadow-sm transition-all duration-200 gap-2",style:{backgroundColor:t.buttonColor||"#6366f1",color:t.buttonTextColor||"#ffffff",opacity:!a||o?.7:1},children:o?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,C.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,C.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,C.jsx)("span",{children:"Processando pagamento..."})]}):(0,C.jsx)("span",{children:h})}),(0,C.jsxs)("div",{className:"mt-4 flex items-center justify-center space-x-2 text-sm text-gray-500",children:[(0,C.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,C.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),(0,C.jsx)("span",{children:d})]})]})};s(18416);let I={text:r.Z,video:a.Z,progressBar:n.Z,checkbox:c.Z,procrastinationChart:i.Z,progress:o.Z,leadCapture:l.Z,feedback:d.Z,flowSelector:u.Z,question:m.Z,button:v.Z,plan:x.Z,timer:p.Z,image:h.Z,circular:g.Z,privacy:f.Z,accordion:y.Z,spacer:j.Z,carousel:b.Z,list:w.Z,instagram:N.Z,audio:k.Z,stripePayment:e=>{let{isEditing:t}=e,s=e.settings.security||"Pagamento seguro via Stripe",r="subscription"===e.settings.mode?"".concat(e.settings.ctaSub||"Assinar por").concat(e.settings.priceButton?" ".concat(B(e.settings.amount,e.settings.currency),"/").concat("year"===e.settings.interval?"ano":"m\xeas"):""):"".concat(e.settings.ctaPay||"Pagar por").concat(e.settings.priceButton?" ".concat(B(e.settings.amount,e.settings.currency)):"");if(t)return(0,C.jsx)("div",{className:"w-full border-t border-b border-dashed border-violet-400",children:(0,C.jsx)("div",{className:"max-w-md mx-auto p-4",children:(0,C.jsxs)("div",{className:"space-y-6",children:[(0,C.jsxs)("div",{className:"flex items-center space-x-2 ",style:{color:e.settings.buttonColor||"#22c55e"},children:[(0,C.jsx)("div",{className:"w-5 h-5 rounded-full border-2 border-current flex items-center justify-center",children:(0,C.jsx)("div",{className:"w-2 h-2 rounded-full bg-current"})}),(0,C.jsx)("div",{className:"w-8 h-5",children:(0,C.jsx)("svg",{viewBox:"0 0 24 16",className:"w-8 h-5",children:(0,C.jsx)("rect",{width:"24",height:"16",rx:"2",fill:"#E5E7EB"})})}),(0,C.jsx)("span",{className:"text-lg font-medium",children:"Cart\xe3o"})]}),(0,C.jsxs)("div",{className:"space-y-1.5",children:[(0,C.jsx)("div",{className:"text-[15px] text-gray-700",children:"N\xfamero do cart\xe3o"}),(0,C.jsxs)("div",{className:"h-[42px] bg-white rounded-lg border border-gray-300 px-3.5 flex items-center justify-between",children:[(0,C.jsx)("div",{className:"text-gray-400 text-[15px]",children:"1234 1234 1234 1234"}),(0,C.jsxs)("div",{className:"flex space-x-2",children:[(0,C.jsx)("img",{src:"https://js.stripe.com/v3/fingerprinted/img/visa-729c05c240c4bdb47b03ac81d9945bfe.svg",className:"w-8 h-5 object-contain",alt:"Visa"}),(0,C.jsx)("img",{src:"https://js.stripe.com/v3/fingerprinted/img/mastercard-4d8844094130711885b5e41b28c9848f.svg",className:"w-8 h-5 object-contain",alt:"Mastercard"})]})]})]}),(0,C.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,C.jsxs)("div",{className:"space-y-1.5",children:[(0,C.jsx)("div",{className:"text-[15px] text-gray-700",children:"Data de validade"}),(0,C.jsx)("div",{className:"h-[42px] bg-white rounded-lg border border-gray-300 px-3.5 flex items-center",children:(0,C.jsx)("div",{className:"text-gray-400 text-[15px]",children:"MM / AA"})})]}),(0,C.jsxs)("div",{className:"space-y-1.5",children:[(0,C.jsx)("div",{className:"text-[15px] text-gray-700",children:"C\xf3digo de seguran\xe7a"}),(0,C.jsxs)("div",{className:"h-[42px] bg-white rounded-lg border border-gray-300 px-3.5 flex justify-between items-center",children:[(0,C.jsx)("div",{className:"text-gray-400 text-[15px]",children:"CVC"}),(0,C.jsx)(E.Z,{className:"text-gray-300"})]})]})]}),(0,C.jsxs)("div",{className:"space-y-1.5",children:[(0,C.jsx)("div",{className:"text-[15px] text-gray-700",children:"Pa\xeds"}),(0,C.jsx)("div",{className:"h-[42px] bg-white rounded-lg border border-gray-300 px-3.5 flex justify-between items-center",children:(0,C.jsx)("div",{className:"text-gray-700",children:"Brasil"})})]}),(0,C.jsx)("button",{style:{backgroundColor:e.settings.buttonColor||"#22c55e",color:e.settings.buttonTextColor||"white"},className:"w-full h-[52px] rounded-lg font-medium shadow-sm hover:opacity-90 transition-opacity text-lg mt-2",disabled:!0,children:r}),(0,C.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-gray-500 mt-4",children:[(0,C.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,C.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),(0,C.jsx)("span",{children:s})]})]})})});let[a,n]=(0,S.useState)(null),[c,i]=(0,S.useState)(null),[o,l]=(0,S.useState)(null),[d,u]=(0,S.useState)(null);if((0,S.useEffect)(()=>{let t=async()=>{try{let t=await fetch("/api/slug/".concat(e.funnelId,"/stripe")),s=await t.json();s.publishableKey&&l((0,Z.J)(s.publishableKey))}catch(e){console.error("Error fetching Stripe key:",e)}};e.preview||t()},[e.funnelId,e.preview]),(0,S.useEffect)(()=>{let t=async()=>{try{let t="subscription"===e.settings.mode?"/api/slug/".concat(e.funnelId,"/stripe/subscription"):"/api/slug/".concat(e.funnelId,"/stripe/payment-intent"),s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Number(e.settings.amount),currency:e.settings.currency||"usd",metadata:e.settings.metadata||{},interval:e.settings.interval})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to create payment intent")}let r=await s.json();"subscription"===e.settings.mode?(n(r.setupIntent),i(r.priceId)):n(r.clientSecret)}catch(e){console.error("Error creating intent:",e),u(e instanceof Error?e.message:"Failed to create payment intent")}};!e.preview&&o&&t()},[e.settings,e.preview,e.funnelId,o]),e.preview)return(0,C.jsx)(L,{...e,preview:!0});if(!a||!o)return null;let m={clientSecret:a,appearance:{theme:"stripe",variables:{colorPrimary:e.settings.buttonColor||"#6366f1",colorBackground:"#ffffff",colorText:"#1f2937",colorDanger:"#dc2626",fontFamily:"Inter var, system-ui, -apple-system, sans-serif",borderRadius:"0.75rem",spacingUnit:"4px"}}};return(0,C.jsx)(P.Elements,{stripe:o,options:m,children:(0,C.jsx)(L,{...e})})},location:e=>{var t,s;let{settings:r,isEditing:a}=e,[n,c]=(0,S.useState)(null);(0,S.useEffect)(()=>{let e=async()=>{try{let e=await fetch("https://myip.wtf/json"),t=await e.json(),s=t.YourFuckingLocation.split(", "),r=s[0],a=s[1];c({YourFuckingLocation:t.YourFuckingLocation,city:r,state:"Brazil"===a?"":a})}catch(e){console.error("Error fetching location:",e)}};a||e()},[a]);let i=(t=r.description||"",(s=a?{YourFuckingLocation:"S\xe3o Paulo, S\xe3o Paulo",city:"S\xe3o Paulo",state:"S\xe3o Paulo"}:n)?t.replace(/{city}/g,s.city||"").replace(/{state}/g,s.state||""):t);return(0,C.jsx)("div",{className:"w-full",children:(0,C.jsx)("div",{className:"flex items-center px-4 py-3 text-sm md:text-base",children:(0,C.jsx)("div",{className:"w-full rich-text-content",style:{color:r.textColor||"#000"},dangerouslySetInnerHTML:{__html:i}})})})}}}}]);