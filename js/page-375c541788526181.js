(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4601],{42480:function(){},70597:function(e,t,n){Promise.resolve().then(n.bind(n,237))},237:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var s=n(57437),o=n(2265),r=n(58110),i=n.n(r),l=n(73172),a=n(16463),c=n(30989),d=n(69065),u=n(66124),m=n(23269),p=n(13100),f=n(74697);let g=o.forwardRef(function(e,t){return(0,s.jsx)(p.Z,{direction:"up",ref:t,...e})});function h(){let[e,t]=o.useState(!1),n=()=>{t(!1)};return(0,s.jsxs)(o.Fragment,{children:[(0,s.jsxs)("div",{className:"flex justify-center items-center mb-2  gap-1 text-xs",children:[(0,s.jsxs)("p",{children:["\xa9 2024 - Criado via ",(0,s.jsx)("a",{href:"https://bkfunnels.com",target:"_blank",className:" hover:underline inline",children:"BK Funnels"})," |"]}),(0,s.jsx)("button",{className:"hover:underline cursor-pointer",onClick:()=>{t(!0)},children:"Central de an\xfancios"})]}),(0,s.jsxs)(d.Z,{open:e,TransitionComponent:g,keepMounted:!0,onClose:n,"aria-describedby":"alert-dialog-slide-description",sx:{".MuiPaper-root":{borderRadius:"10px",backgroundColor:"white",width:420,padding:1.5,p:2}},children:[(0,s.jsxs)("div",{className:"flex md:text-xl text-lg  mb-2 font-bold items-center justify-between",children:["Central de an\xfancios",(0,s.jsx)(f.Z,{size:15,onClick:n})]}),(0,s.jsx)(u.Z,{sx:{padding:0,backgroundColor:"",borderRadius:"10px"},children:(0,s.jsxs)(m.Z,{id:"alert-dialog-slide-description",children:[(0,s.jsxs)("p",{className:"text-[13] text-sm leading-tight mb-2",children:["Voc\xea est\xe1 navegando em uma p\xe1gina criada na plataforma ",(0,s.jsx)("a",{href:"https://bkfunnels.com",target:"_blank",className:"text-blue-600 hover:underline inline",children:"BK Funnels"}),". Caso precise de assist\xeancia, escolha uma das op\xe7\xf5es abaixo:"]}),(0,s.jsxs)("a",{href:"https://www.bkfunnels.com/denuncie",target:"_blank",children:[(0,s.jsx)("div",{className:"flex items-center bg-gray-100 text-black text-sm p-4 rounded-lg justify-center gap-1",children:"Denunciar esta p\xe1gina por abuso"}),"     "]}),(0,s.jsx)("p",{className:"text-[13] pt-5 text-sm leading-tight mb-2",children:"Sua intera\xe7\xe3o nos ajuda a aprimorar continuamente a experi\xeancia dos usu\xe1rios em nossa plataforma. Agradecemos pelo seu contato."}),(0,s.jsxs)("div",{className:"flex text-xs gap-1 mx-auto justify-center pt-2 text-center items-center",children:[(0,s.jsx)("p",{children:"Termos e Condi\xe7\xf5es de Uso"}),"|  ",(0,s.jsx)("p",{children:"Pol\xedtica de Privacidade"})]})]})})]})]})}(0,n(57818).default)(()=>Promise.all([n.e(3070),n.e(2516)]).then(n.t.bind(n,98436,23)),{loadableGenerated:{webpack:()=>[98436]},ssr:!1});let x=async()=>{try{let e=await fetch("https://api.ipify.org?format=json");return(await e.json()).ip}catch(e){return"Unknown IP"}},v=()=>{let e=navigator.userAgent,t=navigator.platform,n=navigator.appVersion,s="Unknown Device";for(let[t,n]of Object.entries({iPhone:/iPhone/,iPad:/iPad/,Android:/Android/,Windows:/Windows/,Mac:/Macintosh/,Linux:/Linux/}))if(n.test(e)){s=t;break}return{userAgent:e,platform:t,appVersion:n,deviceType:s}};var b=e=>{var t;let{params:n}=e,[r,d]=(0,o.useState)(null),[u,m]=(0,o.useState)(0),[p,f]=(0,o.useState)(null),[g,b]=(0,o.useState)(null),[y,w]=(0,o.useState)(null),[j,S]=(0,o.useState)([]),[C,k]=(0,o.useState)([]),[N,_]=(0,o.useState)(0),[E,A]=(0,o.useState)(!0),I=(0,a.useSearchParams)(),O=I.get("utm_source"),T=I.get("utm_medium"),P=I.get("utm_campaign"),L={utm_source:O,utm_content:I.get("utm_content"),utm_term:I.get("utm_term"),utm_medium:T,utm_campaign:P};(0,o.useEffect)(()=>{let e={utm_source:I.get("utm_source"),utm_medium:I.get("utm_medium"),utm_campaign:I.get("utm_campaign"),utm_content:I.get("utm_content"),utm_term:I.get("utm_term")};sessionStorage.setItem("utm_data",JSON.stringify(e))},[I]),(0,o.useEffect)(()=>{let e=setInterval(()=>{_(e=>e+1)},1e3);return()=>clearInterval(e)},[]),(0,o.useEffect)(()=>{(async()=>{if(n.funnel)try{let e=await fetch("/api/slug/".concat(n.funnel,"?flow=0")),t=await e.json();if(e.ok){let e=i().AES.decrypt(t.data,'Er7"GWzS@}:Ahx4LV5s8Q'),n=JSON.parse(e.toString(i().enc.Utf8));d(n),f(n.funnelId),k(n.edges)}else console.error("Falha ao buscar dados do funil")}catch(e){console.error("Erro ao buscar dados do funil:",e)}})()},[n.funnel,g]),(0,o.useEffect)(()=>{if(!(null==r?void 0:r.head))return;let e=[],t=document.head,n=()=>{let n=document.createElement("div");n.innerHTML=r.head,n.querySelectorAll("script").forEach(n=>{if(n.src){if(!t.querySelector('script[src="'.concat(n.src,'"]'))){let s=document.createElement("script");Array.from(n.attributes).forEach(e=>{s.setAttribute(e.name,e.value)}),s.async=n.hasAttribute("async"),s.defer=n.hasAttribute("defer"),t.appendChild(s),e.push(s),console.log("Script externo injetado:",n.src)}}else{var s;let o=document.createElement("script");o.type="text/javascript",Array.from(n.attributes).forEach(e=>{"type"!==e.name&&o.setAttribute(e.name,e.value)}),o.textContent=n.textContent,t.appendChild(o),e.push(o),console.log("Script inline injetado:",(null===(s=o.textContent)||void 0===s?void 0:s.substring(0,50))+"...")}})};return setTimeout(()=>{n()},100),()=>{e.forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)})}},[null==r?void 0:r.head]),(0,o.useEffect)(()=>{document.title=(null==r?void 0:r.seoTitle)||"BK Funnels";let e=document.querySelector('meta[name="description"]');if(e)e.setAttribute("content",(null==r?void 0:r.seoDescription)||"Funis interativos");else{let e=document.createElement("meta");e.setAttribute("name","description"),e.setAttribute("content",(null==r?void 0:r.seoDescription)||"Funis interativos"),document.head.appendChild(e)}let t=document.querySelector('link[rel="icon"]');if(t)t.setAttribute("href",(null==r?void 0:r.favicon)||"");else{let e=document.createElement("link");e.setAttribute("rel","icon"),e.setAttribute("href",(null==r?void 0:r.favicon)||""),document.head.appendChild(e)}(null==r?void 0:r.background)&&(document.body.style.backgroundColor=r.background);let n=()=>{let e=document.querySelectorAll("h1, h2");e&&(null==r?void 0:r.color)&&e.forEach(e=>{e.style.color=r.color})};n();let s=new MutationObserver(()=>{n()});return s.observe(document.body,{childList:!0,subtree:!0}),()=>{s.disconnect()}},[r]),(0,o.useEffect)(()=>{let e=()=>{let e=sessionStorage.getItem("funnel-".concat(p));if(e){let t=JSON.parse(e);t[u]&&(A(!1),S(t[u]))}};return e(),window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[p,u]),(0,o.useEffect)(()=>{window.scrollTo(0,0)},[u]);let q=(0,o.useRef)(!1);if((0,o.useEffect)(()=>{let e=async()=>{if(!p||q.current)return;q.current=!0;let e=localStorage.getItem("bksession"),t=e?JSON.parse(e):null;if(t&&t.funnelId===p&&t.code){w(t.code);return}let n=await x(),s=v();try{let e=await fetch("/api/slug/".concat(p,"/journey"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:y,stepId:null==r?void 0:r.steps[u].id,timestamp:new Date().toISOString(),ip:n,device:s.deviceType,system:s.platform,utm:L})});if(e.ok){let t=await e.json();w(t.id),localStorage.setItem("bksession",JSON.stringify({funnelId:p,code:t.id})),localStorage.setItem("bksession-expiry",(Date.now()+5184e6).toString())}else console.error("Failed to register initial visit")}catch(e){console.error("Error registering initial visit:",e)}};r&&e()},[r,u]),(0,o.useEffect)(()=>{let e=localStorage.getItem("bksession"),t=localStorage.getItem("bksession-expiry");if(e&&t&&Number(t)>Date.now()){let{funnelId:t,code:n}=JSON.parse(e);w(n),b(Number(g))}},[n.funnel]),!r)return null;let M=e=>{let t=String(null==r?void 0:r.steps[u].id),n=C.find(e=>e.source===t),s=null;e&&(s=C.find(n=>n.sourceHandle.substring(n.sourceHandle.lastIndexOf("-")+1)===e[0]&&n.source===t));let o=s?r.steps.findIndex(e=>String(e.id)===String(s.target)):r.steps.findIndex(e=>String(e.id)===String(null==n?void 0:n.target));-1!==o?m(o):(console.error("Target n\xe3o encontrado entre os passos."),u<r.steps.length-1?m(u+1):console.log("Voc\xea est\xe1 na \xfaltima etapa."))},F=async(e,t)=>{if(r){if(!y){console.error("Code not journey");return}try{t.timer=N,(await fetch("https://api-bkfunnels.com/api/".concat(p,"/answers"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:y,stepId:r.steps[e].id,...t})})).ok?console.log("Respostas da etapa atual enviadas com sucesso."):console.error("Falha ao enviar as respostas da etapa atual.")}catch(e){console.error("Erro ao enviar as respostas da etapa atual:",e)}_(0)}},B=null==r?void 0:r.steps[u],J=async()=>{let e=(null==B?void 0:B.modules)||[];if(0===e.length){console.error("No modules found");return}let t=sessionStorage.getItem("funnel-".concat(p)),n={};t&&(n=JSON.parse(t));let s=n[u]||{form:{},answers:[]},o={},r=!1;for(let t of e){var i,l,a,c;switch(t.type){case"question":let n=null==B?void 0:B.modules.find(e=>"question"===e.type),d=null==n?void 0:n.settings.multiresponse,m=Array.isArray(null==s?void 0:s.answers)?s.answers:[],p=m.map(e=>e.split("-").slice(1).join("-"));if(d)m.length<1?(console.warn("M\xednimo de uma resposta n\xe3o selecionado."),r=!0):o.answers=p;else{if(1===p.length){let e=m.map(e=>e.split("-")[0]);if(e){o.answers=p,M(e),await F(u,o);return}o.answers=p,M(),await F(u,o);return}console.warn("Nenhuma op\xe7\xe3o selecionada."),r=!0}break;case"leadCapture":let f=((null===(l=t.settings)||void 0===l?void 0:null===(i=l.options)||void 0===i?void 0:i.filter(e=>e.required))||[]).filter(e=>{let t=s.form||{};return!t[e.id]||""===t[e.id].trim()});if(f.length>0)return f.forEach(e=>{}),r=!0,!0;o.form=s.form;break;case"progress":null==B||B.modules.find(e=>"progress"===e.type);break;case"button":let g=e.some(e=>"question"===e.type);e.some(e=>"leadCapture"===e.type)?console.log("None = question || form"):g?console.log("None = question || form"):((null==t?void 0:null===(a=t.settings)||void 0===a?void 0:a.destination)==="url"?o.answers=["button external"]:o.answers=["button clicked"],console.log("Button clicked:",o));break;case"plan":console.log(t),(null==t?void 0:null===(c=t.settings)||void 0===c?void 0:c.options)&&console.log("\xe9 plano n\xe9")}}r||(M(),await F(u,o))},D=r.steps.length,H=(u+1)/r.steps.length*100,R=null===(t=r.steps[u])||void 0===t?void 0:t.modules.map(e=>e.type),Z={};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("main",{className:"w-full",translate:"no",children:[(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:r.body}}),(0,s.jsxs)("div",{className:"flex p-3  justify-between items-center",children:[(0,s.jsxs)("div",{children:[!0===r.activeArrow&&(0,s.jsx)("button",{className:"text-gray-400",onClick:()=>{m(e=>Math.max(e-1,0))},disabled:0===u,children:(0,s.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.5301 5.47007C10.6705 5.6107 10.7494 5.80132 10.7494 6.00007C10.7494 6.19882 10.6705 6.38945 10.5301 6.53007L5.81007 11.2501H20.0001C20.199 11.2501 20.3898 11.3291 20.5304 11.4697C20.6711 11.6104 20.7501 11.8012 20.7501 12.0001C20.7501 12.199 20.6711 12.3897 20.5304 12.5304C20.3898 12.6711 20.199 12.7501 20.0001 12.7501H5.81007L10.5301 17.4701C10.6038 17.5387 10.6629 17.6215 10.7039 17.7135C10.7448 17.8055 10.7669 17.9048 10.7687 18.0056C10.7704 18.1063 10.7519 18.2063 10.7142 18.2997C10.6765 18.3931 10.6203 18.4779 10.5491 18.5491C10.4779 18.6203 10.3931 18.6765 10.2997 18.7142C10.2063 18.7519 10.1063 18.7704 10.0056 18.7687C9.90485 18.7669 9.80553 18.7448 9.71353 18.7039C9.62153 18.6629 9.53873 18.6038 9.47007 18.5301L3.47007 12.5301C3.32962 12.3894 3.25073 12.1988 3.25073 12.0001C3.25073 11.8013 3.32962 11.6107 3.47007 11.4701L9.47007 5.47007C9.6107 5.32962 9.80132 5.25073 10.0001 5.25073C10.1988 5.25073 10.3894 5.32962 10.5301 5.47007Z",fill:"currentcolor"})})})," "]}),(0,s.jsx)("div",{className:" font-extrabold",children:!0===r.activeLogo&&!(0===u&&r.hideLogoFirstStep)&&(0,s.jsx)("img",{src:r.logo||"",className:"h-10",style:{height:"".concat(r.logoSize,"px")}})}),(0,s.jsxs)("div",{children:[(null==r?void 0:r.progressCount)===!0&&(0,s.jsxs)("p",{style:{color:r.ProgressBarColor},children:[u+1,"/",(0,s.jsx)("span",{className:"",children:D})]})," "]})]}),(null==r?void 0:r.activeProgressBar)===!0&&(0,s.jsx)("div",{className:"px-4",children:(0,s.jsx)(l.Z,{settings:{progress:H,color:r.ProgressBarColor,rounded:10}})}),(0,s.jsx)("div",{className:"flex p-5 w-full mx-auto text-gray-600",children:(0,s.jsx)("div",{className:"max-w-md w-full mx-auto",children:null==B?void 0:B.modules.sort((e,t)=>e.position-t.position).map(e=>{let t=c.u[e.type];return t?(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)(t,{id:e.id,settings:e.settings,funnelId:p,stepIndex:u,steps:null==r?void 0:r.steps,code:y,timer:N,setTimer:_,themeColors:{colorText:r.colorText,buttonColor:r.buttonColor,buttonBackground:r.buttonBackground},onComplete:"progress"===e.type?()=>{!0==e.settings.nextstep&&(M(),console.log("next progress"))}:void 0,onSubmit:"leadCapture"===e.type?F:void 0,onSelect:"question"===e.type?t=>{let n=e.settings,s=null==n?void 0:n.multiresponse;s||1!==t.length?s&&t.length:(console.log(t,"selectedOptions"),J())}:void 0,handleNextStep:J,index:Z,currentStepModules:R,isDisabled:E},e.id)},e.id):null})})}),(0,s.jsx)("footer",{dangerouslySetInnerHTML:{__html:r.footer}}),(0,s.jsx)(h,{})]})})}}},function(e){e.O(0,[512,890,679,7674,2010,1187,9263,6576,2673,2486,6858,8833,4788,6648,4890,3718,5985,2392,2565,1667,989,2971,7023,1744],function(){return e(e.s=70597)}),_N_E=e.O()}]);